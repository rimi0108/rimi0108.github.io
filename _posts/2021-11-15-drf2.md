---
title: "[Django] DRFë¡œ íšŒì›ê°€ì… ê¸°ëŠ¥ êµ¬í˜„í•˜ê¸° - (2)"
excerpt: "django rest frameworkë¡œ ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™” ê¸°ëŠ¥ì„ ì ìš©í•´ë³´ì"

categories:
  - Django
tags:
  - [drf]

toc: true
toc_sticky: true

date: 2021-11-15
last_modified_at: 2021-11-15
---

[[Django] DRFë¡œ íšŒì›ê°€ì… ê¸°ëŠ¥ êµ¬í˜„í•˜ê¸° - (1)](https://rimi0108.github.io/django/drf1/)

ìœ„ ê¸€ì—ì„œ ìœ ì € íšŒì›ê°€ì… ê¸°ëŠ¥ êµ¬í˜„ê¹Œì§€ ì™„ë£Œí•´ë³´ì•˜ë‹¤. ê·¸ëŸ°ë° ë¬¸ì œê°€ í•˜ë‚˜ ë‚¨ì•˜ë‹¤. ë°”ë¡œ dbì— ìœ ì €ì˜ ë¹„ë°€ë²ˆí˜¸ê°€ ê·¸ëŒ€ë¡œ ë“¤ì–´ê°„ë‹¤ëŠ” ê²ƒì´ë‹¤. 

ìœ ì €ì˜ ë¹„ë°€ë²ˆí˜¸ëŠ” ì ˆëŒ€ ë¹„ë°€ë²ˆí˜¸ ê·¸ëŒ€ë¡œ dbì— ì €ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤. dbê°€ í•´í‚¹ì„ ë‹¹í•˜ë©´ ìœ ì €ì˜ ë¹„ë°€ë²ˆí˜¸ë„ ê·¸ëŒ€ë¡œ ë…¸ì¶œë˜ë©° ì™¸ë¶€ í•´í‚¹ì´ ì•„ë‹ˆë”ë¼ë„ ë‚´ë¶€ ê°œë°œìë‚˜ ì¸ë ¥ì´ ìœ ì €ë“¤ì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³¼ ìœ„í—˜ì´ ìˆê¸° ë•Œë¬¸ì´ë‹¤.

ì ì´ì œ, drfë¡œ ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”ë¥¼ ì ìš©í•´ë³´ì.

## hash password

### ë°©ë²•1 (ì‹¤íŒ¨)

ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸ì—ëŠ” ë‹¨ë°©í–¥ í•´ì‹œ í•¨ìˆ˜ê°€ ì¼ë°˜ì ìœ¼ë¡œ ì“°ì¸ë‹¤. drfë¥¼ ì ìš©í•˜ì§€ ì•Šì•˜ì„ ë•Œ ë‚˜ëŠ” bcryptë¥¼ ì´ìš©í•˜ì—¬ ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”ë¥¼ í–ˆë‹¤. drfì—ëŠ” bcryptë¥¼ ì–´ë–»ê²Œ ì ìš©í•˜ëŠ”ì§€ ëª¨ë¥´ê² ì–´ì„œ ì¼ë‹¨ ê²€ìƒ‰ì„ í•´ë´¤ë‹¤. (ë‚˜ì˜ êµ¬ì›ì ìŠ¤íƒì˜¤ë²„í”Œë¡œìš° ğŸ¥º)

https://stackoverflow.com/questions/61065339/how-do-i-hash-passwords-in-drf 

```python
def create(self, validated_data):
    user = super(UserSerializer, self).create(validated_data)
    user.set_password(validated_data['password'])
    user.save()
    return user
```

ìœ„ ìŠ¤íƒì˜¤ë²„í”Œë¡œìš° ë§í¬ì— ë”°ë¼ ìœ„ ì½”ë“œë¥¼ `models.py`ì— ì ìš©í•˜ê³  ì„œë²„ë¥¼ ì‹¤í–‰í•˜ë‹ˆ ë˜ ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤.

`ImportError: cannot import name 'User' from partially initialized module 'accounts.models' (most likely due to a circular import) (/code/accounts/models.py)`

ë˜ ë¨¸ë¦¬ë¥¼ ì‹¸ë§¤ê³  ê²€ìƒ‰í•´ë³´ë‹ˆ ì•„ë§ˆ import í•œ íŒŒì¼ë“¤ì˜ **ìˆœí™˜ ì˜ì¡´ì„±** ë•Œë¬¸ì— ìƒê¸´ ì—ëŸ¬ ê°™ì•˜ë‹¤. => [ë‚˜ë¥¼ êµ¬ì›í•´ì¤€ ë¸”ë¡œê·¸ ë§í¬](https://gardeny.tistory.com/11)


```python
# models.py
from django.contrib.auth.models import BaseUserManager, AbstractBaseUser
from django.db import models

from accounts.serializers import UserSerializer
```

```python
# serializers.py
from rest_framework import serializers
from .models import User
```

ìœ„ëŠ” modelsì— import í•œ ëª¨ë“ˆì´ê³  ë°‘ì€ serializersì— import í•œ ëª¨ë“ˆì´ë‹¤. 

ì•„ë§ˆ modelsì—ì„œë„ serializersë¥¼ ì˜ì¡´í•˜ê³  ìˆê³  serializersì—ì„œë„ modelsë¥¼ ì˜ì¡´í•˜ê³  ìˆì–´ ìƒê¸´ ë¬¸ì œ ê°™ì•˜ë‹¤.

```python
# serializers.py
from rest_framework import serializers

from .models import User

class UserSerializer(serializers.HyperlinkedModelSerializer):
    class Meta:
        model = User
        fields = ["email", "password"]

```

```python
# serializers.py
from rest_framework import serializers


class UserSerializer(serializers.HyperlinkedModelSerializer):
    class Meta:
        model = 'accounts.User'
        fields = ["email", "password"]

```

ìœ„ì²˜ëŸ¼ `models.py`ì—ì„œ Userë¥¼ ë¶ˆëŸ¬ì™€ ì˜ì¡´ì ì´ì—ˆë˜ íŒŒì¼ì„ ë°‘ ì½”ë“œì™€ ê°™ì´ 'accouts.User' ê³¼ ê°™ì´ ë°”ê¿”ì¤€ë‹¤. ì´ì™€ ê°™ì´ ë°”ê¿”ì£¼ë©´ í•´ë‹¹ modelì„ í•„ìš” ì‹œì—ë§Œ import í•´ì˜¤ê¸° ë•Œë¬¸ì— ì˜¤ë¥˜ë¥¼ ë„ìš°ì§€ ì•ŠëŠ”ë‹¤ê³  í•œë‹¤.

ê·¸ëŸ°ë° http://127.0.0.1:8000/users/ ì— ì ‘ì†í•˜ë‹ˆ `'str' object has no attribute '_meta'` ë¼ëŠ” ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤. (ë©ˆì¶”ì§€ ì•ŠëŠ” ì—ëŸ¬..) ì•„ë§ˆ Meta í´ë˜ìŠ¤ì˜ modelì—ëŠ” ë¬¸ìì—´ì´ ë“¤ì–´ê°€ë©´ ì•ˆë˜ëŠ” ê²ƒ ê°™ë‹¤..ğŸ˜±

ìœ„ ìŠ¤íƒì˜¤ë²„í”Œë¡œìš°ì—ì„œ ì°¾ì€ ì½”ë“œëŠ” serializerì„ ì˜ì¡´í•œ ì½”ë“œê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ ë°©ë²•ì„ ì°¾ì•„ë³´ê¸°ë¡œ í–ˆë‹¤. í•˜í•˜..

### ë°©ë²•2 (ì„±ê³µ)

ë˜ êµ¬ê¸€ë§ìœ¼ë¡œ ë’¤ì§€ê³  ë’¤ì§€ë‹¤.. 

https://stackoverflow.com/questions/41332528/how-to-hash-django-user-password-in-django-rest-framework

ìœ„ ë§í¬ì— ë”°ë¼ì„œ í•œë²ˆ `serializers.py`ë¥¼ ìˆ˜ì •í•´ë³´ê¸°ë¡œ í–ˆë‹¤.

```python
# serializers.py
from rest_framework import serializers

from django.contrib.auth.hashers import make_password

from .models import User

class UserSerializer(serializers.HyperlinkedModelSerializer):

    def create(self, validated_data):
        validated_data['password'] = make_password(validated_data['password'])
        return super(UserSerializer, self).create(validated_data)
        
    class Meta:
        model = User
        fields = ["email", "password"]

```

make_passwordëŠ” passwordë¥¼ hash í•´ì£¼ëŠ” ëª¨ë“ˆì¸ ê²ƒ ê°™ë‹¤. ë“¤ì–´ì˜¨ password dataë¥¼ hashí•´ì¤€ í›„ return í•´ì£¼ëŠ” ì½”ë“œ ì¸ë“¯í•˜ë‹¤. ì–´ì¨Œë“  ì´ ì½”ë“œë¥¼ ì ìš©í•´ì£¼ì—ˆë‹¤.

ğŸ˜­ ì„œ..ì„±ê³µí–ˆë‹¤. ë¹„ë°€ë²ˆí˜¸ê°€ ì•”í˜¸í™”ë˜ì–´ ì €ì¥ë˜ì—ˆë‹¤. ê°¬ë™.... drfë¡œ íšŒì›ê°€ì… êµ¬í˜„í•˜ê¸°ë¥¼ ì„±ê³µí–ˆë‹¤! ë‹¤ìŒ ë¯¸ì…˜ì€, ë¡œê·¸ì¸ê³¼ ë¡œê·¸ì•„ì›ƒì´ë‹¤. 